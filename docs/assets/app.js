!function(){"use strict";function e(){for(var e=document,t=["iPhone","iPad","MQQBrowser","Android","MicroMessenger","Trident"],r=navigator.userAgent,i=e.getElementsByTagName("html")[0],o=0;o<t.length;o++){var n=new RegExp(t[o]);r.match(n)&&i.classList.add("ua-"+t[o])}-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome")&&i.classList.add("ua-Safari"),"ontouchstart"in window||i.classList.add("ua-Pointer"),e.getElementsByTagName("body")[0].addEventListener("touchstart",(function(){}),{passive:!0}),e.getElementsByTagName("main")[0].addEventListener("touchstart",(function(){}),{passive:!0})}function t(){var e=document,t=window;Han(e.querySelector(".article")).initCond().renderElem().renderHanging().renderJiya().renderHWS();var r=e.querySelector(".article-body"),i;r.addEventListener("click",(function(o){var n=(i=t.innerWidth||e.clientWidth||e.body.clientWidth)>480?32:28,a=o.offsetX,l=o.offsetY,s=r.offsetWidth,f=r.offsetHeight,c=r.querySelector("p").clientWidth;l<=f&&l>=f-n&&a>=(s-c)/2&&a<=s-(s-c)/2&&(t.location.href=e.querySelector("body").getAttribute("data-root"))}))}function r(){var e=document;Han(e.querySelector(".index-list")).initCond().renderElem().renderJiya().renderHWS();var t=function t(){for(var r=e.querySelectorAll(".index-item"),i=r.length,o=250,n=function e(t){setTimeout((function(){r[t].classList.remove("is-loading")}),o*(t+1))},a=0;a<i;a++)n(a)};e.addEventListener("readystatechange",t)}function i(){var e=document,t=window;Han(e.querySelector(".article")).initCond().renderElem().renderHanging().renderJiya().renderHWS();var r=896,i=-4,o=e.querySelector(".article"),n=e.querySelector(".article-body"),a=e.querySelector(".article-footnote"),l=e.querySelectorAll(".article-footnote li"),s=e.querySelectorAll(".article-body .fn-mark"),f,c,d,y,h,u=function e(){f=o.offsetTop,c=n.offsetWidth,d=n.querySelector("p").offsetLeft,y=n.querySelector("p").offsetWidth,a.style.top=f+"px",a.style.right=c-d-y+"px",a.style.width="";for(var t=0;t<l.length;t++){var r=l[t],i,h=s[t].offsetTop;r.style.top=h+"px",r.style.left=r.style.right="",r.style.setProperty("--arrow-left","")}},p=function r(){f=o.offsetTop,c=n.offsetWidth,d=n.querySelector("p").offsetLeft,y=n.querySelector("p").offsetWidth,a.style.top=f+"px",a.style.right=c-d-y+"px",a.style.width=y+"px";var h=t.getComputedStyle(e.querySelector(".article-body p")).getPropertyValue("line-height");h=h.substring(0,h.length-2);for(var u=0;u<l.length;u++){var p=l[u],g=s[u],v=g.offsetTop,m=g.offsetLeft,S=g.offsetWidth;p.style.top=v+parseInt(h,10)+"px",m<=c/2?(p.style.left="0px",p.style.right=""):(p.style.left="",p.style.right="0px");var W,b=m-(p.offsetLeft+(c-y)/2)+S/2+i;p.style.setProperty("--arrow-left",b-2+"px")}},g=function r(h){f=o.offsetTop,c=n.offsetWidth,d=n.querySelector("p").offsetLeft,y=n.querySelector("p").offsetWidth,a.style.top=f+"px",a.style.right=c-d-y+"px",a.style.width=y+"px";var u=t.getComputedStyle(e.querySelector(".article-body p")).getPropertyValue("line-height");u=u.substring(0,u.length-2);var p=l[h],g=s[h],v=g.offsetTop,m=g.offsetLeft,S=g.offsetWidth;p.style.top=v+parseInt(u,10)+"px",m<=c/2?(p.style.left="0px",p.style.right=""):(p.style.left="",p.style.right="0px");var W,b=m-(p.offsetLeft+(c-y)/2)+S/2+i;p.style.setProperty("--arrow-left",b-2+"px")};if(l.length>0&&s.length>0){t.addEventListener("load",(function(){(h=t.innerWidth||e.clientWidth||e.body.clientWidth)>r&&u()})),t.addEventListener("resize",(function(){(h=t.innerWidth||e.clientWidth||e.body.clientWidth)>r?u():p()}));for(var v=function e(i){var o;s[i].addEventListener("click",(function(e){e.preventDefault(),h>r||(g(i),l[i].classList.toggle("is-active"));for(var o=e.target;o&&!o.matches(".article-body a.fn-mark, body");)o=o.parentNode;if(o&&o.matches(".article-body a.fn-mark")){var n="#"+o.getAttribute("id");n!==t.location.hash&&history.replaceState({},"",n)}}))},m=0;m<s.length;m++)v(m);e.addEventListener("click",(function(t){for(var r=t.target;r&&!r.matches(".article-footnote li.is-active, .fn-mark, body");)r=r.parentNode;if(!r||!r.matches(".article-footnote li.is-active, .fn-mark"))for(var i=e.querySelectorAll(".article-footnote li.is-active"),o=0;o<i.length;o++)i[o].classList.remove("is-active")}))}n.addEventListener("click",(function(r){var i=(h=t.innerWidth||e.clientWidth||e.body.clientWidth)>480?32:28,o=r.offsetX,a=r.offsetY,l=n.offsetWidth,s=n.offsetHeight,f=n.querySelector("p").clientWidth;a<=s&&a>=s-i&&o>=(l-f)/2&&o<=l-(l-f)/2&&(t.location.href=e.querySelector("body").getAttribute("data-root"))}))}var o=document,n;switch(e(),o.querySelector("body").classList[0]){case"http404":t();break;case"index":r();break;case"essay":i();break}}();